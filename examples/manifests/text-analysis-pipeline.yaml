apiVersion: v1
kind: Pipeline
metadata:
  name: text-analysis-pipeline
  description: Analyze text using custom plugin nodes
  version: "1.0"
  tags: ["text-processing", "analysis", "plugin-example"]

spec:
  # Define expected input schema
  input_schema:
    type: object
    properties:
      article_text:
        type: string
        description: Text article to analyze
    required: [article_text]

  nodes:
    # Extract keywords from the article
    - kind: function
      metadata:
        name: extract_keywords
        annotations:
          description: Extract key terms from article using NER
      spec:
        fn: extract_keywords_fn
        dependencies: []

    # Analyze sentiment
    - kind: function
      metadata:
        name: analyze_sentiment
        annotations:
          description: Determine article sentiment using DistilBERT
      spec:
        fn: analyze_sentiment_fn
        dependencies: []

    # Create summary
    - kind: function
      metadata:
        name: summarize_text
        annotations:
          description: Generate article summary using BART
      spec:
        fn: summarize_text_fn
        dependencies: []

    # Combine results into final report
    - kind: function
      metadata:
        name: generate_report
        annotations:
          description: Combine analysis results
      spec:
        fn: create_analysis_report
        dependencies: [extract_keywords, analyze_sentiment, summarize_text]
